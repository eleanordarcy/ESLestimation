Ff <- 1-(exprob*(1+xi*((y-q[j])/sigma))^(-1/xi))
}
}
else if(j==9){
## We standardise day for Model R1
sd <- day-mean(Sep$day)
## Below the threshold use the monthly empirical look up table for specific tidal band
q1 <- sort(Sep$maxTide)[0.333*length(Sep$maxTide)]
q2 <- sort(Sep$maxTide)[0.667*length(Sep$maxTide)]
if(y<=q[j]){
if(t<=q1){
Ff <- Sep1_emp_skews(round(y,3)) #monthly empirical CDF for lowest tidal band
}
else if( t>q1 & t<=q2){
Ff <- Sep2_emp_skews(round(y,3))
}
else{
Ff <- Sep3_emp_skews(round(y,3))
}
}
## Above the threshold use the GPD with harmonics on scale and rate
else{
## Scale harmonic
sigma <- a+b*(sin(((2*pi)/365)*(i-p)))+t*c
## Rate harmonic
beta_0 <- log(0.05/0.95)+sd*(rate[1]*sin(((2*pi)/365)*(i-rate[2])))
beta_1 <- rate[3]+rate[4]*(sin(((2*pi)/365)*(i-rate[5])))
exprob <-exp(beta_0+(beta_1*st))/(1+exp(beta_0+(beta_1*st)))
Ff <- 1-(exprob*(1+xi*((y-q[j])/sigma))^(-1/xi))
}
}
else if(j==10){
## We standardise day for Model R1
sd <- day-mean(Oct$day)
## Below the threshold use the monthly empirical look up table for specific tidal band
q1 <- sort(Oct$maxTide)[0.333*length(Oct$maxTide)]
q2 <- sort(Oct$maxTide)[0.667*length(Oct$maxTide)]
if(y<=q[j]){
if(t<=q1){
Ff <- Oct1_emp_skews(round(y,3)) #monthly empirical CDF for lowest tidal band
}
else if( t>q1 & t<=q2){
Ff <- Oct2_emp_skews(round(y,3))
}
else{
Ff <- Oct3_emp_skews(round(y,3))
}
}
## Above the threshold use the GPD with harmonics on scale and rate
else{
## Scale harmonic
sigma <- a+b*(sin(((2*pi)/365)*(i-p)))+t*c
## Rate harmonic
beta_0 <- log(0.05/0.95)+sd*(rate[1]*sin(((2*pi)/365)*(i-rate[2])))
beta_1 <- rate[3]+rate[4]*(sin(((2*pi)/365)*(i-rate[5])))
exprob <- exp(beta_0+(beta_1*st))/(1+exp(beta_0+(beta_1*st)))
Ff <- 1-(exprob*(1+xi*((y-q[j])/sigma))^(-1/xi))
}
}
else if(j==11){
## We standardise day for Model R1
sd <- day-mean(Nov$day)
## Below the threshold use the monthly empirical look up table for specific tidal band
q1 <- sort(Nov$maxTide)[0.333*length(Nov$maxTide)]
q2 <- sort(Nov$maxTide)[0.667*length(Nov$maxTide)]
if(y<=q[j]){
if(t<=q1){
Ff <- Nov1_emp_skews(round(y,3)) #monthly empirical CDF for lowest tidal band
}
else if( t>q1 & t<=q2){
Ff <- Nov2_emp_skews(round(y,3))
}
else{
Ff<- Nov3_emp_skews(round(y,3))
}
}
## Above the threshold use the GPD with harmonics on scale and rate
else{
## Scale harmonic
sigma <- a+b*(sin(((2*pi)/365)*(i-p)))+t*c
## Rate harmonic
beta_0 <- log(0.05/0.95)+sd*(rate[1]*sin(((2*pi)/365)*(i-rate[2])))
beta_1 <- rate[3]+rate[4]*(sin(((2*pi)/365)*(i-rate[5])))
exprob <-exp(beta_0+(beta_1*st))/(1+exp(beta_0+(beta_1*st)))
Ff <- 1-(exprob*(1+xi*((y-q[j])/sigma))^(-1/xi))
}
}
else if(j==12){
## We standardise day for Model R1
sd <- day-mean(Dec$day)
## Below the threshold use the monthly empirical look up table for specific tidal band
q1 <- sort(Dec$maxTide)[0.333*length(Dec$maxTide)]
q2 <- sort(Dec$maxTide)[0.667*length(Dec$maxTide)]
if(y<=q[j]){
if(t<=q1){
Ff <- Dec1_emp_skews(round(y,3)) #monthly empirical CDF for lowest tidal band
}
else if( t>q1 & t<=q2){
Ff <- Dec2_emp_skews(round(y,3))
}
else{
Ff <- Dec3_emp_skews(round(y,3))
}
}
## Above the threshold use the GPD with harmonics on scale and rate
else{
## Scale harmonic
sigma <- a+b*(sin(((2*pi)/365)*(i-p)))+t*c
## Rate harmonic
beta_0 <- log(0.05/0.95)+sd*(rate[1]*sin(((2*pi)/365)*(i-rate[2])))
beta_1 <- rate[3]+rate[4]*(sin(((2*pi)/365)*(i-rate[5])))
exprob <- exp(beta_0+(beta_1*st))/(1+exp(beta_0+(beta_1*st)))
Ff <- 1-(exprob*(1+xi*((y-q[j])/sigma))^(-1/xi))
}
}
return(Ff)
}
# Transforming ss margins -------------------------------------------------
#data <- readRDS('data_HEY_mean0.rds')
for(i in 1:length(data$skews)){
data$unif[i] <- F_ss(data$skews[i],data$day[i],data$month[i], data$maxTide[i], c(gpd_par, rate_par))
}
plot(data$unif,ylim=c(0,1))
data$gumbel <- -log(-log(data$unif))
plot(data$gumbel)
# for( i in 1:(length(data$skews)-1) ){
#   print(i)
#   if( abs(difftime(data$datetime[i], data$datetime[i+1], unit='hours')) > 15 ){
#     data[i,] <- NA
#   }
# }
# data_missing <- data
data$normal <- qnorm(exp(-exp(-data$gumbel)))
# data2000 <- data %>% filter(year==1994)
# t <- c()
# for(i in 1:(length(data2000$skews)-1)){
#   t[i] <- abs(difftime(data2000$datetime[i], data2000$datetime[i+1], unit='hours')) > 15
# }
# sum(t==TRUE)
t <- c()
for( i in 1:(length(data$skews)-6) ){
if( abs(difftime(data$datetime[i], data$datetime[i+1], unit='hours')) > 15 | abs(difftime(data$datetime[i+1], data$datetime[i+2], unit='hours')) > 15 | abs(difftime(data$datetime[i+2], data$datetime[i+3], unit='hours')) > 15 |
abs(difftime(data$datetime[i+3], data$datetime[i+4], unit='hours')) > 15 | abs(difftime(data$datetime[i+4], data$datetime[i+5], unit='hours')) > 15 | abs(difftime(data$datetime[i+5], data$datetime[i+6], unit='hours')) > 15 ){
t[i] <- 0
}
else{
t[i] <- 1
}
}
N0 <- sum(t)
# Logistic k=1 ----------------------------------------------------------------
log_density <- function(x, y, alpha){
a <- alpha
aux<- exp(-a*x)+exp(-a*y)
A<-aux^(1/a-2)
B<-aux^(1/a)+(a-1)
C <- exp(-aux^(1/a)-a*(x+y))
dens<-A*B*C
return(dens)
}
log_ll <- function(par,x){
l <- c()
if( par > 1){
for( i in 1:(length(x$skews)-6) ){
if( abs(difftime(x$datetime[i], x$datetime[i+1], unit='hours')) > 15 | abs(difftime(x$datetime[i+1], x$datetime[i+2], unit='hours')) > 15 | abs(difftime(x$datetime[i+2], x$datetime[i+3], unit='hours')) > 15
| abs(difftime(x$datetime[i+3], x$datetime[i+4], unit='hours')) > 15 | abs(difftime(x$datetime[i+4], x$datetime[i+5], unit='hours')) > 15 | abs(difftime(x$datetime[i+5], x$datetime[i+6], unit='hours')) > 15 ){
l[i] <- NA
}
else{
l[i] <- log(log_density(x$gumbel[i], x$gumbel[i+1], alpha = par)/exp(-(x$gumbel[i]+exp(-x$gumbel[i]))))
}
}
return(sum(l, na.rm=T))
}
else{
return(-1e7)
}
}
(log_mod <- optim(par=3, fn=log_ll, x=data, control=list(fnscale=-1), hessian=FALSE, method='Brent', lower=1.001, upper=15))
AIC <- 2*1-2*log_mod$value
BIC <- 1*log(N0)-2*log_mod$value
saveRDS(c(1/log_mod$par,AIC,BIC),paste0('Results/Copula_fits/',ID,'_L1.rds'))
AIC
BIC
HEY_G6_harmonic_simple <- readRDS("C:/Users/darcye/OneDrive - Lancaster University/phd/Flood_Barriers/Skew_surge/Code/Updates_2024/Results/Copula_fits/HEY_G6_harmonic_simple.rds")
setwd("C:/Users/darcye/OneDrive - Lancaster University/phd/Flood_Barriers/Skew_surge/Code/Updates_2024")
HEY <- readRDS("Results/Copula_fits/HEY_G6_harmonic_simple.rds")
rho1 <- sapply(1:365, function(d)  HEY_par[1] + HEY_par[2] * (sin(((2*pi)/365)*(d-HEY_par[3]))))
HEY_par <- readRDS("Results/Copula_fits/HEY_HEY_paronic_simple.rds")
rho1 <- sapply(1:365, function(d)  HEY_par[1] + HEY_par[2] * (sin(((2*pi)/365)*(d-HEY_par[3]))))
setwd("C:/Users/darcye/OneDrive - Lancaster University/phd/Flood_Barriers/Skew_surge/Code/Updates_2024")
HEY_par <- readRDS("Results/Copula_fits/HEY_HEY_paronic_simple.rds")
HEY_par <- readRDS("Results/Copula_fits/HEY_G6_harmonic_simple.rds")
rho1 <- sapply(1:365, function(d)  HEY_par[1] + HEY_par[2] * (sin(((2*pi)/365)*(d-HEY_par[3]))))
rho2 <- sapply(1:365, function(d)  HEY_par[4] + HEY_par[5] * (sin(((2*pi)/365)*(d-HEY_par[6]))))
rho1
rho2
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- rho5_cond <- rho6_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4, rho5, rho6)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3, rho4, rho5,
rho1[d], 1, rho1[d], rho2[d], rho3, rho4,
rho2[d], rho1[d], 1, rho1[d], rho2[d], rho3[d],
rho3, rho2[d], rho1[d], 1, rho1[d], rho2[d],
rho4, rho3, rho2[d], rho1[d], 1, rho1[d],
rho5, rho4, rho3, rho2[d], rho1[d], 1), nrow=6)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
rho5_cond[d] <- (rho %*% solve(Sig))[5]
rho6_cond[d] <- (rho %*% solve(Sig))[6]
}
rho3 <- HEY_par[7]
rho4 <- HEY_par[8]
rho5<- HEY_par[9]
rho6<- HEY_par[10]
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- rho5_cond <- rho6_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4, rho5, rho6)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3, rho4, rho5,
rho1[d], 1, rho1[d], rho2[d], rho3, rho4,
rho2[d], rho1[d], 1, rho1[d], rho2[d], rho3[d],
rho3, rho2[d], rho1[d], 1, rho1[d], rho2[d],
rho4, rho3, rho2[d], rho1[d], 1, rho1[d],
rho5, rho4, rho3, rho2[d], rho1[d], 1), nrow=6)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
rho5_cond[d] <- (rho %*% solve(Sig))[5]
rho6_cond[d] <- (rho %*% solve(Sig))[6]
}
range_G6_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)), paste0(signif(min(rho5_cond),2), ',', signif(max(rho5_cond),2)), paste0(signif(min(rho6_cond),2), ',', signif(max(rho6_cond),2)))
range_G6_harm
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- rho5_cond <- rho6_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4, rho5, rho6)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3, rho4, rho5,
rho1[d], 1, rho1[d], rho2[d], rho3, rho4,
rho2[d], rho1[d], 1, rho1[d], rho2[d], rho3,
rho3, rho2[d], rho1[d], 1, rho1[d], rho2[d],
rho4, rho3, rho2[d], rho1[d], 1, rho1[d],
rho5, rho4, rho3, rho2[d], rho1[d], 1), nrow=6)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
rho5_cond[d] <- (rho %*% solve(Sig))[5]
rho6_cond[d] <- (rho %*% solve(Sig))[6]
}
range_G6_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)), paste0(signif(min(rho5_cond),2), ',', signif(max(rho5_cond),2)), paste0(signif(min(rho6_cond),2), ',', signif(max(rho6_cond),2)))
range_G6_harm
# LOW Model 3 k=4 ---------------------------------------------------------
LOW_par <- readRDS("Results/Copula_fits/LOW_G4_harmonic_simple.rds")
rho1 <- sapply(1:365, function(d)  LOW_par[1] + LOW_par[2] * (sin(((2*pi)/365)*(d-LOW_par[3]))))
rho2 <- sapply(1:365, function(d)  LOW_par[4] + LOW_par[5] * (sin(((2*pi)/365)*(d-LOW_par[6]))))
rho3 <- LOW_par[7]
rho4 <- LOW_par[8]
rho5<- LOW_par[9]
rho6<- LOW_par[10]
LOW_par[10]
LOW_par[8]
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3,
rho1[d], 1, rho1[d], rho2[d],
rho2[d], rho1[d], 1, rho1[d],
rho3, rho2[d], rho1[d], 1), nrow=4)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
}
range_G4_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)))
range_G4_harm
# LOW Model 3 k=4
# HEY Model 3 k=6 ---------------------------------------------------------
NEW_par <- readRDS("Results/Copula_fits/NEW_G5_harmonic.rds")
rho1 <- sapply(1:365, function(d)  HEY_par[1] + HEY_par[2] * (sin(((2*pi)/365)*(d-HEY_par[3]))))
rho2 <- sapply(1:365, function(d)  HEY_par[4] + HEY_par[5] * (sin(((2*pi)/365)*(d-HEY_par[6]))))
rho3 <- sapply(1:365, function(d)  HEY_par[7] + HEY_par[8] * (sin(((2*pi)/365)*(d-HEY_par[9]))))
rho4 <- sapply(1:365, function(d)  HEY_par[10] + HEY_par[11] * (sin(((2*pi)/365)*(d-HEY_par[12]))))
rho5 <- sapply(1:365, function(d)  HEY_par[13] + HEY_par[14] * (sin(((2*pi)/365)*(d-HEY_par[15]))))
rho5
rho1 <- sapply(1:365, function(d)  NEW_par[1] + NEW_par[2] * (sin(((2*pi)/365)*(d-NEW_par[3]))))
rho5
rho2 <- sapply(1:365, function(d)  NEW_par[4] + NEW_par[5] * (sin(((2*pi)/365)*(d-NEW_par[6]))))
rho3 <- sapply(1:365, function(d)  NEW_par[7] + NEW_par[8] * (sin(((2*pi)/365)*(d-NEW_par[9]))))
rho4 <- sapply(1:365, function(d)  NEW_par[10] + NEW_par[11] * (sin(((2*pi)/365)*(d-NEW_par[12]))))
rho5 <- sapply(1:365, function(d)  NEW_par[13] + NEW_par[14] * (sin(((2*pi)/365)*(d-NEW_par[15]))))
rho5
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- rho5_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3[d], rho4[d], rho5[d])
Sig <- matrix(c(1, rho1[d], rho2[d], rho3[d], rho4[d],
rho1[d], 1, rho1[d], rho2[d], rho3[d],
rho2[d], rho1[d], 1, rho1[d], rho2[d],
rho3[d], rho2[d], rho1[d], 1, rho1[d],
rho4[d], rho3[d], rho2[d], rho1[d], 1), nrow=5)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
rho5_cond[d] <- (rho %*% solve(Sig))[5]
}
range_G5_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)), paste0(signif(min(rho5_cond),2), ',', signif(max(rho5_cond),2)))
range_G5_harm
# SHE Model 3 k=4 ---------------------------------------------------------
SHE_par <- readRDS("Results/Copula_fits/SHE_G4_harmonic_simple.rds")
rho1 <- sapply(1:365, function(d)  SHE_par[1] + SHE_par[2] * (sin(((2*pi)/365)*(d-SHE_par[3]))))
rho2 <- sapply(1:365, function(d)  SHE_par[4] + SHE_par[5] * (sin(((2*pi)/365)*(d-SHE_par[6]))))
rho3 <- SHE_par[7]
rho4 <- SHE_par[8]
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3,
rho1[d], 1, rho1[d], rho2[d],
rho2[d], rho1[d], 1, rho1[d],
rho3, rho2[d], rho1[d], 1), nrow=4)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
}
range_G4_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)))
range_G4_harm
plot(1:365, rho1_cond, type='l' cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.8), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', lty=2)
points(1:365, rho3_cond, type='l', lty=3)
points(1:365, rho4_cond, type='l', lty=4)
pdf(file=paste0("Figures/SHE_modelpars", ID, '.pdf'),width=6,height=6)
par(mfrow=c(1,1),mgp=c(2.3,1,0),mar=c(5,4,4,2)+0.1)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.8), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', lty=2)
points(1:365, rho3_cond, type='l', lty=3)
points(1:365, rho4_cond, type='l', lty=4)
dev.off()
NEW_par <- readRDS("Results/Copula_fits/NEW_G5_harmonic.rds")
rho1 <- sapply(1:365, function(d)  NEW_par[1] + NEW_par[2] * (sin(((2*pi)/365)*(d-NEW_par[3]))))
rho2 <- sapply(1:365, function(d)  NEW_par[4] + NEW_par[5] * (sin(((2*pi)/365)*(d-NEW_par[6]))))
rho3 <- sapply(1:365, function(d)  NEW_par[7] + NEW_par[8] * (sin(((2*pi)/365)*(d-NEW_par[9]))))
rho4 <- sapply(1:365, function(d)  NEW_par[10] + NEW_par[11] * (sin(((2*pi)/365)*(d-NEW_par[12]))))
rho5 <- sapply(1:365, function(d)  NEW_par[13] + NEW_par[14] * (sin(((2*pi)/365)*(d-NEW_par[15]))))
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- rho5_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3[d], rho4[d], rho5[d])
Sig <- matrix(c(1, rho1[d], rho2[d], rho3[d], rho4[d],
rho1[d], 1, rho1[d], rho2[d], rho3[d],
rho2[d], rho1[d], 1, rho1[d], rho2[d],
rho3[d], rho2[d], rho1[d], 1, rho1[d],
rho4[d], rho3[d], rho2[d], rho1[d], 1), nrow=5)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
rho5_cond[d] <- (rho %*% solve(Sig))[5]
}
range_G5_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)), paste0(signif(min(rho5_cond),2), ',', signif(max(rho5_cond),2)))
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.8), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
pdf(file=paste0("Figures/SHE_modelpars", ID, '.pdf'),width=6,height=6)
par(mfrow=c(1,1),mgp=c(2.3,1,0),mar=c(5,4,4,2)+0.1)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', lty=2)
points(1:365, rho3_cond, type='l', lty=3)
points(1:365, rho4_cond, type='l', lty=4)
dev.off()
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', lty=2)
points(1:365, rho3_cond, type='l', lty=3)
points(1:365, rho4_cond, type='l', lty=4)
points(1:365, rho5_cond, type='l', lty=5)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
points(1:365, rho5_cond, type='l', col='orange')
dev.off()
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
points(1:365, rho5_cond, type='l', col='orange')
pdf(file=paste0("Figures/NEW_modelpars", ID, '.pdf'),width=6,height=6)
par(mfrow=c(1,1),mgp=c(2.3,1,0),mar=c(5,4,4,2)+0.1)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
points(1:365, rho5_cond, type='l', col='orange')
dev.off()
rho1 <- sapply(1:365, function(d)  SHE_par[1] + SHE_par[2] * (sin(((2*pi)/365)*(d-SHE_par[3]))))
rho2 <- sapply(1:365, function(d)  SHE_par[4] + SHE_par[5] * (sin(((2*pi)/365)*(d-SHE_par[6]))))
rho3 <- SHE_par[7]
rho4 <- SHE_par[8]
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3,
rho1[d], 1, rho1[d], rho2[d],
rho2[d], rho1[d], 1, rho1[d],
rho3, rho2[d], rho1[d], 1), nrow=4)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
}
range_G4_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)))
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
pdf(file=paste0("Figures/SHE_modelpars", ID, '.pdf'),width=6,height=6)
par(mfrow=c(1,1),mgp=c(2.3,1,0),mar=c(5,4,4,2)+0.1)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
dev.off()
rho1 <- sapply(1:365, function(d)  LOW_par[1] + LOW_par[2] * (sin(((2*pi)/365)*(d-LOW_par[3]))))
rho2 <- sapply(1:365, function(d)  LOW_par[4] + LOW_par[5] * (sin(((2*pi)/365)*(d-LOW_par[6]))))
rho3 <- LOW_par[7]
rho4 <- LOW_par[8]
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3,
rho1[d], 1, rho1[d], rho2[d],
rho2[d], rho1[d], 1, rho1[d],
rho3, rho2[d], rho1[d], 1), nrow=4)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
}
range_G4_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)))
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
pdf(file=paste0("Figures/LOW_modelpars", ID, '.pdf'),width=6,height=6)
par(mfrow=c(1,1),mgp=c(2.3,1,0),mar=c(5,4,4,2)+0.1)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
dev.off()
rho1 <- sapply(1:365, function(d)  HEY_par[1] + HEY_par[2] * (sin(((2*pi)/365)*(d-HEY_par[3]))))
rho2 <- sapply(1:365, function(d)  HEY_par[4] + HEY_par[5] * (sin(((2*pi)/365)*(d-HEY_par[6]))))
rho3 <- HEY_par[7]
rho4 <- HEY_par[8]
rho5<- HEY_par[9]
rho6<- HEY_par[10]
rho1_cond <- rho2_cond <- rho3_cond <- rho4_cond <- rho5_cond <- rho6_cond <- c()
for(d in 1:365){
rho <- c(rho1[d], rho2[d], rho3, rho4, rho5, rho6)
Sig <- matrix(c(1, rho1[d], rho2[d], rho3, rho4, rho5,
rho1[d], 1, rho1[d], rho2[d], rho3, rho4,
rho2[d], rho1[d], 1, rho1[d], rho2[d], rho3,
rho3, rho2[d], rho1[d], 1, rho1[d], rho2[d],
rho4, rho3, rho2[d], rho1[d], 1, rho1[d],
rho5, rho4, rho3, rho2[d], rho1[d], 1), nrow=6)
rho1_cond[d] <- (rho %*% solve(Sig))[1]
rho2_cond[d] <- (rho %*% solve(Sig))[2]
rho3_cond[d] <- (rho %*% solve(Sig))[3]
rho4_cond[d] <- (rho %*% solve(Sig))[4]
rho5_cond[d] <- (rho %*% solve(Sig))[5]
rho6_cond[d] <- (rho %*% solve(Sig))[6]
}
range_G6_harm <- c(paste0(signif(min(rho1),2), ',', signif(max(rho1),2)), paste0(signif(min(rho2_cond),2), ',', signif(max(rho2_cond),2)), paste0(signif(min(rho3_cond),2), ',', signif(max(rho3_cond),2)), paste0(signif(min(rho4_cond),2), ',', signif(max(rho4_cond),2)), paste0(signif(min(rho5_cond),2), ',', signif(max(rho5_cond),2)), paste0(signif(min(rho6_cond),2), ',', signif(max(rho6_cond),2)))
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
points(1:365, rho5_cond, type='l', col='orange')
points(1:365, rho6_cond, type='l', col='magenta')
pdf(file=paste0("Figures/HEY_modelpars", ID, '.pdf'),width=6,height=6)
par(mfrow=c(1,1),mgp=c(2.3,1,0),mar=c(5,4,4,2)+0.1)
plot(1:365, rho1_cond, type='l', xlab='Day', ylab=expression(tilde(rho)), ylim=c(-0.1,0.9), cex.lab=1.5, cex.main=1, cex.axis=1.2, cex.sub=1.2)
points(1:365, rho2_cond, type='l', col='blue')
points(1:365, rho3_cond, type='l', col='red')
points(1:365, rho4_cond, type='l', col='green')
points(1:365, rho5_cond, type='l', col='orange')
points(1:365, rho6_cond, type='l', col='magenta')
dev.off()
load("C:/Users/darcye/Documents/Downloads/wavenumber_spectra (1).RData")
View(wavenumber_spectra)
rm(list=ls())
### When changing documentation
library(roxygen2)
setwd("C:/Users/darcye/OneDrive - Lancaster University/phd/Extreme_SL_est/Code/Sea_Levels_Git/ESLestimation")
load("C:/Users/darcye/OneDrive - Lancaster University/phd/Extreme_SL_est/Code/Sea_Levels_Git/ESLestimation/data/Lowestoft.RData")
Lowestoft[,-c(5,7)]
Lowestoft <- Lowestoft[,-c(5,7)]
save(Lowestoft, file='Lowestoft.RData')
getwd()
load("C:/Users/darcye/OneDrive - Lancaster University/phd/Extreme_SL_est/Code/Sea_Levels_Git/ESLestimation/data/Lowestoft.RData")
remove.packages("ESLestimation")
rm(list=ls())
### When changing documentation
library(roxygen2)
setwd("C:/Users/darcye/OneDrive - Lancaster University/phd/Extreme_SL_est/Code/Sea_Levels_Git/ESLestimation")
roxygen2::roxygenise()
library(devtools)
install_github('eleanordarcy/ESL_estimation/ESLestimation')
library(devtools)
install_github('eleanordarcy/ESL_estimation/ESLestimation')
library(ESLestimation)
